import{a as le,b as ae}from"./chunk-FUEW5RMK.js";import{b as J}from"./chunk-CHEY6AMV.js";import{a as re}from"./chunk-3F3WB2GL.js";import{a as ue}from"./chunk-VMNXJX5W.js";import{b as Q,c as C,e as W,f as Z,j as ee,m as te,n as ie,q as ne,s as oe}from"./chunk-P22SP4ST.js";import"./chunk-KOTN3JSS.js";import{$b as R,Bd as X,Dd as Y,Gd as K,Hc as H,Ib as a,Ic as O,Id as D,Jb as P,Jd as $,Kb as M,Nc as U,Od as z,Qb as B,Qc as L,Rb as F,Sa as s,U as j,_ as h,_b as q,ab as w,da as A,e as de,f as S,gb as p,ib as u,lb as E,nb as y,oa as g,pa as x,rb as o,sb as r,tb as d,u as G,xb as T,yb as f,zb as c}from"./chunk-NAS4OXTP.js";var b=de(ue());var se=(()=>{class n{constructor(){this.firestore=h(X),this._promotionCollection=K(this.firestore,"promotions")}getProductDiscounts(e){return S(this,null,function*(){let i=D(this.firestore,"promotions",e);return yield $(i).then(t=>t.exists()?t.data():(console.error("No such document!"),null)).catch(t=>(console.error("Error getting document:",t),null))})}getPromotions(){return Y(this._promotionCollection,{idField:"id"}).pipe(G(e=>{let i=new Date,t=i.getHours().toString().padStart(2,"0")+":"+i.getMinutes().toString().padStart(2,"0");return e.filter(l=>l.startTime<=t&&l.endTime>=t)}))}setProductDiscounts(e,i){return S(this,null,function*(){let t=D(this.firestore,"promotions/"+e);return yield z(t,i).then(()=>{}).catch(l=>(console.error("Error getting document:",l),null))})}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275prov=j({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var ce=()=>({"border-width":"1px"});function fe(n,m){n&1&&(o(0,"div",12)(1,"p",35),a(2," * "),r()())}function pe(n,m){n&1&&(o(0,"div",12)(1,"p",35),a(2," * "),r()())}function ge(n,m){n&1&&(o(0,"div",36),a(1," Nombre es requerido "),r())}function xe(n,m){if(n&1&&(o(0,"td",49),a(1),q(2,"uppercase"),r()),n&2){let e=c().$implicit;s(),M("MESA ",R(2,1,e),"")}}function be(n,m){if(n&1){let e=T();o(0,"td")(1,"form",50),f("ngSubmit",function(){g(e);let t=c().index,l=c(2);return x(l.updateTable(t))}),o(2,"input",51),f("blur",function(){g(e);let t=c().index,l=c(2);return x(l.updateTable(t))})("keydown.enter",function(){g(e);let t=c().index,l=c(2);return x(l.updateTable(t))}),r()()()}if(n&2){let e=c(3);s(),u("formGroup",e.editTableForm),s(),E(F(3,ce))}}function _e(n,m){if(n&1){let e=T();o(0,"button",52),f("click",function(){g(e);let t=c().index,l=c(2);return x(l.updateTable(t))}),d(1,"i",53),r()}}function he(n,m){if(n&1){let e=T();o(0,"button",54),f("click",function(){g(e);let t=c().index,l=c(2);return x(l.editTable(t))}),d(1,"i",55),r()}}function Ce(n,m){if(n&1){let e=T();o(0,"tr",41),p(1,xe,3,3,"td",42)(2,be,3,4,"td",43),o(3,"td",44),p(4,_e,2,0,"button",45)(5,he,2,0,"button",46),o(6,"button",47),f("click",function(){let t=g(e).index,l=c(2);return x(l.deleteTable(t))}),d(7,"i",48),r()()()}if(n&2){let e=m.index,i=c(2);s(),u("ngIf",i.editingTableId!==e),s(),u("ngIf",i.editingTableId===e),s(2),u("ngIf",i.editingTableId===e),s(),u("ngIf",i.editingTableId!==e)}}function Te(n,m){if(n&1&&(o(0,"div",31)(1,"table",37)(2,"thead",38)(3,"tr",38)(4,"th",39),a(5,"Nombre de la mesa"),r()()(),o(6,"tbody",17),p(7,Ce,8,4,"tr",40),r()()()),n&2){let e=c();s(7),u("ngForOf",e.tables())}}function ve(n,m){n&1&&(o(0,"div",17)(1,"p",56),a(2,"No hay mesas registradas"),r()())}var Re=(()=>{class n{ngOnInit(){this.getConfigs()}constructor(){this.fb=h(ne),this.kitchenService=h(re),this.promotionsService=h(se),this.configsForm=w(this.fb.group({CashPaymentToGoStatus:[!1,[C.required]],ProductDiscountEnabled:[!1,[C.required]],ProductDiscountStartTime:[null,[C.required]],ProductDiscountEndTime:[null,[C.required]],tableName:[null]})),this.editTableForm=this.fb.group({name:["",C.required]}),this.editingTableId=null,this.tables=w([])}saveConfigs(){let e={CashPaymentToGoStatus:this.configsForm().get("CashPaymentToGoStatus")?.value,ProductDiscountEnabled:this.configsForm().get("ProductDiscountEnabled")?.value,ProductDiscountStartTime:this.configsForm().get("ProductDiscountStartTime")?.value,ProductDiscountEndTime:this.configsForm().get("ProductDiscountEndTime")?.value};try{if(!this.configsForm().valid){b.default.fire({title:"Error",text:"Por favor completa todos los campos",icon:"error",confirmButtonText:"Aceptar"});return}this.kitchenService.saveConfigs(e).then(()=>{}).catch(i=>{throw new Error("Error al guardar configuraciones de cocina: "+i)}),this.promotionsService.setProductDiscounts("3X2TYT3A5",{enabled:e.ProductDiscountEnabled,startTime:e.ProductDiscountStartTime,endTime:e.ProductDiscountEndTime}).then(()=>{}).catch(i=>{throw new Error("Error al guardar descuentos de productos: "+i)}),this.saveTables(),b.default.fire({title:"Configuraciones guardadas",text:"Las configuraciones se han guardado correctamente",icon:"success",confirmButtonText:"Aceptar"}),this.configsForm().markAsPristine()}catch(i){b.default.fire({title:"Error",text:"Ocurri\xF3 un error al guardar las configuraciones: "+i,icon:"error",confirmButtonText:"Aceptar"})}}getConfigs(){this.kitchenService.getConfigs().subscribe(e=>{e&&this.configsForm().patchValue({CashPaymentToGoStatus:e.CashPaymentToGoStatus})}),this.promotionsService.getProductDiscounts("3X2TYT3A5").then(e=>{e&&this.configsForm().patchValue({ProductDiscountEnabled:e.enabled,ProductDiscountStartTime:e.startTime,ProductDiscountEndTime:e.endTime})}),this.getTables()}resetConfigs(){this.getConfigs(),b.default.fire({title:"Configuraciones restauradas",text:"Las configuraciones se han restaurado a los valores por defecto",icon:"success",confirmButtonText:"Aceptar"}),this.configsForm().markAsPristine(),this.editTableForm.reset(),this.editingTableId=null}getTables(){this.kitchenService.getTables().subscribe(e=>{this.tables.set(Array.isArray(e)?e:[])})}saveTables(){this.kitchenService.saveTables(this.tables()).then(()=>{this.editTableForm.reset(),this.editingTableId=null})}addTable(){let e=this.configsForm().get("tableName")?.value||"";if(!e){b.default.fire({title:"Error",text:"Por favor ingresa un nombre para la mesa",icon:"error",confirmButtonText:"Aceptar"});return}if(this.tables().includes(e.toUpperCase())){b.default.fire({title:"Error",text:"El nombre de la mesa ya existe",icon:"error",confirmButtonText:"Aceptar"}),this.configsForm().get("tableName")?.setValue(null);return}let t=[...this.tables(),e.toUpperCase()];this.tables.set(t),this.configsForm().get("tableName")?.setValue(null)}deleteTable(e){let i=[...this.tables()];i.splice(e,1),this.tables.set(i),this.editTableForm.reset(),this.editingTableId=null}editTable(e){this.editingTableId=e,this.editTableForm.patchValue({name:this.tables()[e]})}updateTable(e){if(this.editTableForm.valid){let i=[...this.tables()];i[e]=this.editTableForm.get("name")?.value,this.tables.set(i),this.editTableForm.reset(),this.editingTableId=null}}static{this.\u0275fac=function(i){return new(i||n)}}static{this.\u0275cmp=A({type:n,selectors:[["app-configs"]],standalone:!0,features:[B],decls:64,vars:12,consts:[[1,"w-full","h-full","bg-white","nunito-regular","p-4"],[1,"text-2xl","nunito-extra-bold","text-gray-800"],[1,"flex","flex-col","gap-4","mt-4"],[1,"nunito-regular",3,"formGroup"],[1,"my-2"],[1,"flex","flex-row","gap-4","items-center","justify-start"],[1,"flex","flex-col","gap-4"],[1,"nunito-bold","text-lg","md:text-start","text-center"],[1,"flex","gap-2","items-center","justify-center","md:justify-start"],["formControlName","CashPaymentToGoStatus",1,"h-full","flex","items-center",3,"ngModel"],["for","CashPaymentToGoStatus",1,"flex","w-auto","text-center","h-full","text-nowrap","items-center"],[1,"text-center","flex","items-center","text-nowrap","text","text-sm"],[1,"flex","gap-2","items-center","justify-start"],[1,"flex","md:flex-row","flex-col","gap-8","items-center","justify-start"],["formControlName","ProductDiscountEnabled",1,"h-full","flex","items-center",3,"ngModel"],["for","ProductDiscountEnabled",1,"flex","w-auto","text-center","h-full","text-nowrap","items-center"],[1,"flex","flex-row","gap-4","align-center","justify-start"],[1,"flex","flex-col","gap-2"],["for","ProductDiscountEndTime",1,"text-sm"],["type","time","id","ProductDiscountEndTime","formControlName","ProductDiscountStartTime",1,"border","rounded","px-2","py-1","text-sm"],["type","time","id","ProductDiscountEndTime","formControlName","ProductDiscountEndTime",1,"border","rounded","px-2","py-1","text-sm"],[1,"nunito-bold","text-lg","text-center","md:text-start"],[1,"flex","flex-col","gap-8","items-center","justify-start"],[1,"flex","flex-col","gap-2","items-start","md:items-center","justify-start"],[1,"nunito-bold","text-lg","text-center","w-full"],[1,"flex","md:flex-row","flex-col","gap-2","items-end","justify-start","p-2"],[1,"p-field","flex","flex-col"],["for","tableName"],["id","tableName","type","text","pInputText","","formControlName","tableName",1,"border-c-gray-100","rounded-md","py-2","px-1","focus:border-orange-500","shadow-md","focus:shadow-orange-300","focus:outline-none","focus:ring-0","outline-none"],["class","p-error",4,"ngIf"],[1,"bg-green-500","text-white","px-4","py-2","rounded-md","md:w-fit","w-full",3,"click"],[1,"mt-3","w-full","max-h-96","overflow-auto","no-scrollbar"],[1,"flex","gap-2","items-center","justify-end","mb-2"],["type","button",1,"bg-green-500","text-white","px-4","py-2","rounded","hover:bg-green-600",3,"click"],["type","button",1,"bg-gray-300","text-gray-700","px-4","py-2","rounded","hover:bg-gray-400",3,"click"],[1,"text-lg","text-red-500"],[1,"p-error"],[1,"w-full","mt-3"],[1,""],[1,"text-xl","nunito-extra-bold"],["class","flex justify-between border-c-gray-100 items-center h-full border-b-2 mb-2 pb-1",4,"ngFor","ngForOf"],[1,"flex","justify-between","border-c-gray-100","items-center","h-full","border-b-2","mb-2","pb-1"],["class","flex items-center h-full text-lg nunito-regular",4,"ngIf"],[4,"ngIf"],[1,"flex","gap-2"],["class","bg-green-500 text-white px-4 py-2 rounded-md",3,"click",4,"ngIf"],["class","bg-yellow-500 text-white px-4 py-2 rounded-md",3,"click",4,"ngIf"],[1,"bg-red-500","text-white","px-4","py-2","rounded-md",3,"click"],[1,"pi","pi-trash"],[1,"flex","items-center","h-full","text-lg","nunito-regular"],[3,"ngSubmit","formGroup"],["type","text","pInputText","","formControlName","name",1,"border-c-gray-100","rounded-md","py-2","px-1","focus:border-orange-500","focus:shadow-md","focus:shadow-orange-300","focus:outline-none","focus:ring-0","outline-none",3,"blur","keydown.enter"],[1,"bg-green-500","text-white","px-4","py-2","rounded-md",3,"click"],[1,"pi","pi-check"],[1,"bg-yellow-500","text-white","px-4","py-2","rounded-md",3,"click"],[1,"pi","pi-pencil"],[1,"text-lg","text-gray-500"]],template:function(i,t){if(i&1&&(o(0,"div",0)(1,"div")(2,"h1",1),a(3,"Configuraciones"),r()(),o(4,"div",2)(5,"form",3),d(6,"hr",4),o(7,"div",5)(8,"div",6)(9,"div",7)(10,"h3"),a(11,"Pago con efectivo en pedidos para llevar"),r()(),o(12,"div",8),d(13,"p-inputSwitch",9),o(14,"label",10)(15,"span",11),a(16),r()()()(),p(17,fe,3,0,"div",12),r(),d(18,"hr",4),o(19,"div",6)(20,"div",7)(21,"h3"),a(22,"3x2 en tacos y tostadas"),r()(),o(23,"div",13)(24,"div",12),d(25,"p-inputSwitch",14),o(26,"label",15)(27,"span",11),a(28),r()()(),o(29,"div",16)(30,"div",17)(31,"label",18),a(32,"Hora de inicio:"),r(),d(33,"input",19),r(),o(34,"div",17)(35,"label",18),a(36,"Hora de fin:"),r(),d(37,"input",20),r()(),p(38,pe,3,0,"div",12),r()(),d(39,"hr",4),o(40,"div",6)(41,"div",21)(42,"h3"),a(43,"Mesas"),r()(),o(44,"div",22)(45,"div",23)(46,"div",24),a(47," Agregar mesa "),r(),o(48,"div",25)(49,"div",26)(50,"label",27),a(51,"Nombre de la mesa"),r(),d(52,"input",28),p(53,ge,2,0,"div",29),r(),o(54,"button",30),f("click",function(){return t.addTable()}),a(55,"Agregar"),r()()(),p(56,Te,8,1,"div",31)(57,ve,3,0),r()(),d(58,"hr",4),o(59,"div",32)(60,"button",33),f("click",function(){return t.saveConfigs()}),a(61,"Guardar"),r(),o(62,"button",34),f("click",function(){return t.resetConfigs()}),a(63,"Restablecer"),r()()()()()),i&2){let l,k,I,N,V,_,v;s(5),u("formGroup",t.configsForm()),s(8),u("ngModel",(l=t.configsForm().get("CashPaymentToGoStatus"))==null?null:l.value),s(3),P((k=t.configsForm().get("CashPaymentToGoStatus"))!=null&&k.getRawValue()?"Disponible":"No Disponible"),s(),y(17,(I=t.configsForm().get("CashPaymentToGoStatus"))!=null&&I.dirty?17:-1),s(8),u("ngModel",(N=t.configsForm().get("ProductDiscountEnabled"))==null?null:N.value),s(3),P((V=t.configsForm().get("ProductDiscountEnabled"))!=null&&V.getRawValue()?"Habilitada":"No Habilitada"),s(10),y(38,(_=t.configsForm().get("ProductDiscountEnabled"))!=null&&_.dirty||(_=t.configsForm().get("ProductDiscountEndTime"))!=null&&_.dirty||(_=t.configsForm().get("ProductDiscountStartTime"))!=null&&_.dirty?38:-1),s(14),E(F(11,ce)),s(),u("ngIf",((v=t.configsForm().get("tableName"))==null?null:v.invalid)&&((v=t.configsForm().get("tableName"))==null?null:v.touched)),s(3),y(56,t.tables().length?56:57)}},dependencies:[ae,le,L,H,O,U,oe,ee,Q,W,Z,te,ie,J]})}}return n})();export{Re as ConfigsComponent};
