import{a as Y,b as K}from"./chunk-FUEW5RMK.js";import{a as X}from"./chunk-CGW4C6WT.js";import{a as U}from"./chunk-VMNXJX5W.js";import{b as I,c as d,e as V,f as R,j as B,m as H,n as q,q as L,s as O}from"./chunk-P22SP4ST.js";import"./chunk-KOTN3JSS.js";import{Bd as N,Dd as k,Gd as M,Ib as a,Id as C,Jb as S,Jd as j,Od as A,Qb as _,Qc as G,Sa as l,U as D,_ as m,ab as F,da as w,e as Q,f as g,gb as h,ib as p,nb as x,rb as n,sb as i,tb as c,u as b,yb as v}from"./chunk-NAS4OXTP.js";var f=Q(U());var z=(()=>{class r{constructor(){this.firestore=m(N),this._promotionCollection=M(this.firestore,"promotions")}getProductDiscounts(t){return g(this,null,function*(){let o=C(this.firestore,"promotions",t);return yield j(o).then(e=>e.exists()?e.data():(console.error("No such document!"),null)).catch(e=>(console.error("Error getting document:",e),null))})}getPromotions(){return k(this._promotionCollection,{idField:"id"}).pipe(b(t=>{let o=new Date,e=o.getHours().toString().padStart(2,"0")+":"+o.getMinutes().toString().padStart(2,"0");return t.filter(s=>s.startTime<=e&&s.endTime>=e)}))}setProductDiscounts(t,o){return g(this,null,function*(){let e=C(this.firestore,"promotions/"+t);return yield A(e,o).then(()=>{}).catch(s=>(console.error("Error getting document:",s),null))})}static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275prov=D({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();function Z(r,J){r&1&&(n(0,"div",8)(1,"p",23),a(2," * "),i()())}function $(r,J){r&1&&(n(0,"div",8)(1,"p",23),a(2," * "),i()())}var gt=(()=>{class r{constructor(){this.fb=m(L),this.kitchenService=m(X),this.promotionsService=m(z),this.configsForm=F(this.fb.group({CashPaymentToGoStatus:[!1,[d.required]],ProductDiscountEnabled:[!1,[d.required]],ProductDiscountStartTime:[null,[d.required]],ProductDiscountEndTime:[null,[d.required]]}))}ngOnInit(){this.getConfigs()}saveConfigs(){let t={CashPaymentToGoStatus:this.configsForm().get("CashPaymentToGoStatus")?.value,ProductDiscountEnabled:this.configsForm().get("ProductDiscountEnabled")?.value,ProductDiscountStartTime:this.configsForm().get("ProductDiscountStartTime")?.value,ProductDiscountEndTime:this.configsForm().get("ProductDiscountEndTime")?.value};try{if(!this.configsForm().valid){f.default.fire({title:"Error",text:"Por favor completa todos los campos",icon:"error",confirmButtonText:"Aceptar"});return}this.kitchenService.saveConfigs(t).then(()=>{}).catch(o=>{throw new Error("Error al guardar configuraciones de cocina: "+o)}),this.promotionsService.setProductDiscounts("3X2TYT3A5",{enabled:t.ProductDiscountEnabled,startTime:t.ProductDiscountStartTime,endTime:t.ProductDiscountEndTime}).then(()=>{}).catch(o=>{throw new Error("Error al guardar descuentos de productos: "+o)}),f.default.fire({title:"Configuraciones guardadas",text:"Las configuraciones se han guardado correctamente",icon:"success",confirmButtonText:"Aceptar"}),this.configsForm().markAsPristine()}catch(o){f.default.fire({title:"Error",text:"Ocurri\xF3 un error al guardar las configuraciones: "+o,icon:"error",confirmButtonText:"Aceptar"})}}getConfigs(){this.kitchenService.getConfigs().subscribe(t=>{t&&this.configsForm().patchValue({CashPaymentToGoStatus:t.CashPaymentToGoStatus})}),this.promotionsService.getProductDiscounts("3X2TYT3A5").then(t=>{t&&this.configsForm().patchValue({ProductDiscountEnabled:t.enabled,ProductDiscountStartTime:t.startTime,ProductDiscountEndTime:t.endTime})})}resetConfigs(){this.getConfigs(),f.default.fire({title:"Configuraciones restauradas",text:"Las configuraciones se han restaurado a los valores por defecto",icon:"success",confirmButtonText:"Aceptar"}),this.configsForm().markAsPristine()}static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275cmp=w({type:r,selectors:[["app-configs"]],standalone:!0,features:[_],decls:45,vars:7,consts:[[1,"w-full","h-full","bg-white","nunito-regular","p-4"],[1,"text-2xl","nunito-extra-bold","text-gray-800"],[1,"flex","flex-col","gap-4","mt-4"],[1,"nunito-regular",3,"formGroup"],[1,"my-2"],[1,"flex","flex-row","gap-4","items-center","justify-start"],[1,"flex","flex-col","gap-4"],[1,"nunito-bold","text-lg"],[1,"flex","gap-2","items-center","justify-start"],["formControlName","CashPaymentToGoStatus",1,"h-full","flex","items-center",3,"ngModel"],["for","CashPaymentToGoStatus",1,"flex","w-auto","text-center","h-full","text-nowrap","items-center"],[1,"text-center","flex","items-center","text-nowrap","text","text-sm"],[1,"flex","gap-8","items-center","justify-start"],["formControlName","ProductDiscountEnabled",1,"h-full","flex","items-center",3,"ngModel"],["for","ProductDiscountEnabled",1,"flex","w-auto","text-center","h-full","text-nowrap","items-center"],[1,"flex","flex-row","gap-4","align-center","justify-start"],[1,"flex","flex-col","gap-2"],["for","ProductDiscountEndTime",1,"text-sm"],["type","time","id","ProductDiscountEndTime","formControlName","ProductDiscountStartTime",1,"border","rounded","px-2","py-1","text-sm"],["type","time","id","ProductDiscountEndTime","formControlName","ProductDiscountEndTime",1,"border","rounded","px-2","py-1","text-sm"],[1,"flex","gap-2","items-center","justify-end"],["type","button",1,"bg-green-500","text-white","px-4","py-2","rounded","hover:bg-green-600",3,"click"],["type","button",1,"bg-gray-300","text-gray-700","px-4","py-2","rounded","hover:bg-gray-400",3,"click"],[1,"text-lg","text-red-500"]],template:function(o,e){if(o&1&&(n(0,"div",0)(1,"div")(2,"h1",1),a(3,"Configuraciones"),i()(),n(4,"div",2)(5,"form",3),c(6,"hr",4),n(7,"div",5)(8,"div",6)(9,"div",7)(10,"h3"),a(11,"Pago con efectivo en pedidos para llevar"),i()(),n(12,"div",8),c(13,"p-inputSwitch",9),n(14,"label",10)(15,"span",11),a(16),i()()()(),h(17,Z,3,0,"div",8),i(),c(18,"hr",4),n(19,"div",6)(20,"div",7)(21,"h3"),a(22,"3x2 en tacos y tostadas"),i()(),n(23,"div",12)(24,"div",8),c(25,"p-inputSwitch",13),n(26,"label",14)(27,"span",11),a(28),i()()(),n(29,"div",15)(30,"div",16)(31,"label",17),a(32,"Hora de inicio:"),i(),c(33,"input",18),i(),n(34,"div",16)(35,"label",17),a(36,"Hora de fin:"),i(),c(37,"input",19),i()(),h(38,$,3,0,"div",8),i()(),c(39,"hr",4),n(40,"div",20)(41,"button",21),v("click",function(){return e.saveConfigs()}),a(42,"Guardar"),i(),n(43,"button",22),v("click",function(){return e.resetConfigs()}),a(44,"Restablecer"),i()()()()()),o&2){let s,P,T,y,E,u;l(5),p("formGroup",e.configsForm()),l(8),p("ngModel",(s=e.configsForm().get("CashPaymentToGoStatus"))==null?null:s.value),l(3),S((P=e.configsForm().get("CashPaymentToGoStatus"))!=null&&P.getRawValue()?"Disponible":"No Disponible"),l(),x(17,(T=e.configsForm().get("CashPaymentToGoStatus"))!=null&&T.dirty?17:-1),l(8),p("ngModel",(y=e.configsForm().get("ProductDiscountEnabled"))==null?null:y.value),l(3),S((E=e.configsForm().get("ProductDiscountEnabled"))!=null&&E.getRawValue()?"Habilitada":"No Habilitada"),l(10),x(38,(u=e.configsForm().get("ProductDiscountEnabled"))!=null&&u.dirty||(u=e.configsForm().get("ProductDiscountEndTime"))!=null&&u.dirty||(u=e.configsForm().get("ProductDiscountStartTime"))!=null&&u.dirty?38:-1)}},dependencies:[K,Y,G,O,B,I,V,R,H,q]})}}return r})();export{gt as ConfigsComponent};
